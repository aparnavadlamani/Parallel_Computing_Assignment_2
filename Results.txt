Results

From the stats: 
num_threads = 6 for input_size<400 
num_threads = 12 for input_size>=400

Stats

Number of Threads = 1 (Constant)
Threshold = 0.01 (Constant)
Duration in milliseconds

Matrix Size | Iterations    | Duration 
10          | 18            | 0
20          | 13            | 0
30          | 14            | 1
40          | 3             | 0
50          | 36            | 2
100         | 15            | 4
200         | 15            | 17
300         | 9             | 20
400         | 14            | 55
500         | 7             | 38
1000        | 11            | 225
2000        | 33            | 2810
3000        | 39            | 7417
4000        | 15            | 5123
5000        | 12            | 6347
10000       | 11            | 22819
20000       | 31            | 256304

Number of Threads = 2 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 18            | 0
20          | 13            | 0
30          | 14            | 0
40          | 3             | 0
50          | 8             | 0
100         | 15            | 2
200         | 10            | 7
300         | 9             | 12
400         | 8             | 18
500         | 4             | 14
1000        | 11            | 114
2000        | 17            | 729
3000        | 6             | 585
4000        | 4             | 681
5000        | 12            | 3182
10000       | 9             | 9355
20000       | 10            | 41516

Number of Threads = 4 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 6             | 0
20          | 7             | 0
30          | 4             | 0
40          | 3             | 0
50          | 6             | 0
100         | 6             | 1
200         | 10            | 3
300         | 7             | 6
400         | 8             | 9
500         | 4             | 6
1000        | 8             | 54
2000        | 17            | 466
3000        | 5             | 306
4000        | 4             | 434
5000        | 6             | 1059
10000       | 4             | 2730
20000       | 8             | 22426

Number of Threads = 6 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 3             | 0
20          | 6             | 0
30          | 9             | 0
40          | 3             | 0
50          | 7             | 0
100         | 4             | 0
200         | 6             | 2
300         | 3             | 2
400         | 8             | 9
500         | 6             | 11
1000        | 8             | 47
2000        | 5             | 121
3000        | 6             | 329
4000        | 8             | 804
5000        | 6             | 928
10000       | 5             | 2727
20000       | 8             | 17713

Number of Threads = 8 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 6             | 7
20          | 5             | 4
30          | 6             | 4
40          | 3             | 10
50          | 4             | 1
100         | 6             | 8
200         | 7             | 11
300         | 7             | 11
400         | 4             | 7
500         | 4             | 15
1000        | 8             | 37
2000        | 7             | 133
3000        | 5             | 183
4000        | 4             | 396
5000        | 5             | 696
10000       | 3             | 1418
20000       | 4             | 7593

Number of Threads = 10 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 7             | 1
20          | 5             | 1
30          | 5             | 1
40          | 3             | 0
50          | 4             | 1
100         | 3             | 1
200         | 4             | 3
300         | 4             | 4
400         | 2             | 2
500         | 4             | 10
1000        | 3             | 20
2000        | 4             | 107
3000        | 4             | 200
4000        | 4             | 385
5000        | 4             | 547
10000       | 4             | 2128
20000       | 7             | 13811

Number of Threads = 12 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 3             | 2
20          | 6             | 2
30          | 2             | 1
40          | 3             | 1
50          | 4             | 1
100         | 4             | 1
200         | 4             | 2
300         | 3             | 3
400         | 5             | 8
500         | 3             | 7
1000        | 6             | 36
2000        | 2             | 50
3000        | 5             | 231
4000        | 2             | 179
5000        | 4             | 567
10000       | 2             | 1549
20000       | 2             | 3975

Number of Threads = 14 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 6             | 1
20          | 3             | 1
30          | 3             | 1
40          | 3             | 1
50          | 6             | 1
100         | 3             | 1
200         | 4             | 2
300         | 2             | 5
400         | 6             | 6
500         | 4             | 9
1000        | 5             | 29
2000        | 7             | 150
3000        | 4             | 179
4000        | 4             | 359
5000        | 5             | 720
10000       | 3             | 1526
20000       | 4             | 7653

Number of Threads = 16 (Constant)
Threshold = 0.01 (Constant)

Matrix Size | Iterations    | Duration 
10          | 1             | 1
20          | 4             | 2
30          | 5             | 1
40          | 3             | 0
50          | 2             | 1
100         | 5             | 1
200         | 3             | 2
300         | 3             | 5
400         | 3             | 4
500         | 4             | 8
1000        | 4             | 20
2000        | 7             | 136
3000        | 4             | 178
4000        | 4             | 349
5000        | 5             | 697
10000       | 3             | 1452
20000       | 4             | 7807

